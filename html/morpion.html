<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Morpion</title>
</head>
<body>

    <nav>
        <ul>
            <li><a href="index2.html" class="txt">Accueil</a></li>
            <li><a href="index2.html#container-propos" class="txt">Qui suis-je</a></li>
            <li><a href="index2.html#container-realisation" class="txt">Projet</a></li>
            <li><a href="#" class="txt">Contact</a></li>
        </ul>
    </nav>

    <h1 id="player-turn">Joueur 1 (croix)</h1>


        <div id="box">
            <div id="1" class="case"><svg></svg></div>
            <div id="2" class="case"><svg></svg></div>
            <div id="3" class="case"><svg></svg></div>
            <div id="4" class="case"><svg></svg></div>
            <div id="5" class="case"><svg></svg></div>
            <div id="6" class="case"><svg></svg></div>
            <div id="7" class="case"><svg></svg></div>
            <div id="8" class="case"><svg></svg></div>
            <div id="9" class="case"><svg></svg></div>
        </div>
</body>
<style>

    *{
        list-style-type: none;
        text-decoration: none;
        margin: 0;
        padding: 0;
    }
    html,body{
        width: 100%;
        height: 100%;
        margin: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        background-color: #000517;
    }

    h1{
        color: #fff;
        text-align: center;
        font-family: Arial, Helvetica, sans-serif;
        margin-bottom: 50px;
    }
    
    .container{
        width: 100%;
        height: 100%;
        margin: 0;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    #box{
        display: flex;
        width: 600px;
        aspect-ratio: 1/1;
        padding: 1%;
        flex-wrap: wrap;
    }

    .case{
        width: 31%;
        aspect-ratio: 1/1;
        border: 1px solid #fff;
        cursor: pointer;
        display: flex;
        justify-content: center;
        align-items: center;
        transition: all .3s;
    }

    .case:nth-child(3n){
        border-right: none;
    }

    .case:nth-child(3n +1){
        border-left: none;
    }

    .case:nth-child(-n + 3){
        border-top: none;
    }

    .case:nth-last-child(-n+3) {
        border-bottom: none;
    }


    svg{
        width: 100%;
        height: 100%;
    }

    /* Nav bar */

    nav{
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 15px;
        position: fixed;
        width: 100%;
        top: 0;
    }

    nav ul{
        display: flex;
        justify-content: space-around;
        align-items: center;
        width: 50%;
    }

    nav ul li a{
        color: #fff;
        font-size: 17px;
        font-family: 'Martel Sans';
        position: relative;
        padding: 0 5px;
    }

    nav ul li a:hover:before{
        width: 100%;
    }

    nav ul li a:before{
        content: "";
        position: absolute;
        background-color: #fff;
        height: 2px;
        width: 0%;
        bottom: 0;
        left: 0;
        transition: all .3s;
        border-radius: 10px;
    }

    .logo{
        position: fixed;
        top: 5px;
        left: 5px;
        height: 80px;
    }
    /* Fin Nav bar */

</style>
<script>
const cases = Array.prototype.slice.call(document.getElementsByClassName('case'));
let tour = 0;
let Table = [
    [undefined, undefined, undefined],
    [undefined, undefined, undefined],
    [undefined, undefined, undefined]
];
const joueur = document.getElementById('player-turn');

cases.forEach(element => {
    const svg = element.childNodes[0];
    const id = element.id;
    element.addEventListener('click', () => {
        if (Table[Math.floor((id - 1) / 3)][(id - 1) % 3] === undefined) {
            if (tour === 0) {
                croix(element, svg);
                tour = 1;
                Table[Math.floor((id - 1) / 3)][(id - 1) % 3] = 1;
                joueur.textContent = "Joueur 2 (rond)";
                setTimeout(() => {
                    win('croix');
                }, 10);
            } else {
                rond(element, svg);
                tour = 0;
                Table[Math.floor((id - 1) / 3)][(id - 1) % 3] = 0;
                joueur.textContent = "Joueur 1 (croix)";
                setTimeout(() => {
                    win('rond');
                }, 10);
            }
        } else {
            console.error("Il y a déjà un symbole dans cette case !");
        }
    });
});

const croix = (element, svg) => {
    const taille = element.offsetWidth;

    const line1 = document.createElementNS("http://www.w3.org/2000/svg", "line");
    line1.setAttribute("x1", taille * 0.2);
    line1.setAttribute("x2", taille * 0.8);
    line1.setAttribute("y1", taille * 0.2);
    line1.setAttribute("y2", taille * 0.8);
    line1.setAttribute("stroke", "red");
    line1.setAttribute("stroke-width", "4");

    const line2 = document.createElementNS("http://www.w3.org/2000/svg", "line");
    line2.setAttribute("x1", taille * 0.2);
    line2.setAttribute("x2", taille * 0.8);
    line2.setAttribute("y1", taille * 0.8);
    line2.setAttribute("y2", taille * 0.2);
    line2.setAttribute("stroke", "red");
    line2.setAttribute("stroke-width", "4");

    svg.appendChild(line1);
    svg.appendChild(line2);
};

const rond = (element, svg) => {
    const taille = element.offsetWidth;

    const rond = document.createElementNS("http://www.w3.org/2000/svg", "circle");
    rond.setAttribute("cx", taille * 0.5);
    rond.setAttribute("cy", taille * 0.5);
    rond.setAttribute("r", taille * 0.35);
    rond.setAttribute("stroke", "green");
    rond.setAttribute("stroke-width", "4");
    rond.setAttribute("fill", "transparent");

    svg.appendChild(rond);
};

const win = (rondCroix) => {
    const conditions = [
        [[0, 0], [0, 1], [0, 2]],
        [[1, 0], [1, 1], [1, 2]],
        [[2, 0], [2, 1], [2, 2]],
        [[0, 0], [1, 0], [2, 0]],
        [[0, 1], [1, 1], [2, 1]],
        [[0, 2], [1, 2], [2, 2]],
        [[0, 0], [1, 1], [2, 2]],
        [[0, 2], [1, 1], [2, 0]]
    ];

    let rechercheGagnant = false;

    for (const condition of conditions) {
        const [x1, y1] = condition[0];
        const [x2, y2] = condition[1];
        const [x3, y3] = condition[2];

        if (Table[x1][y1] !== undefined && Table[x1][y1] === Table[x2][y2] && Table[x2][y2] === Table[x3][y3]) {
            alert("Le joueur gagnant est avec les " + rondCroix);
            reni();
            rechercheGagnant = true;
            break;
        }
    }

    if (!rechercheGagnant && !Table.flat().includes(undefined)) {
        alert("match nul !");
        reni();
    }
};



const reni = () => {
    Table = [
        [undefined, undefined, undefined],
        [undefined, undefined, undefined],
        [undefined, undefined, undefined]
    ];

    cases.forEach(element => {
        const svg = element.childNodes[0];
        svg.innerHTML = "";
    });

    joueur.textContent = "Joueur 1 (rond)";
};



</script>
</html>